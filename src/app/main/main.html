<!--Row holding the query text box -->
<nav class="navbar navbar-inverse navbar-static-top top-row">
  <span class="navbar-brand top-row-navbar-brand">Connectivity Matrix</span>
</nav>

<div class="container-fluid full-height">
  <!-- Row holding the controls (left-most col) and matrix (right-ish cols) -->
  <div class="row animate-show main-row" ng-show="!main.hasActiveQuery && !main.hasQueryError">

    <span class="col-md-2 full-height">
      <h4>Query</h4>
        <query-directive submit="main.onQuerySubmitted(query)"></query-directive>
      <hr>
      <h4>Matrix Controls</h4>
      <div class="control-header">
        <b>Collapse rows</b>
        <ui-select ng-model="main.ui.selectedCategoricalRowAttr"
                   ng-change="main.onCollapseRowsByAttr(main.ui.selectedCategoricalRowAttr)">
          <ui-select-match placeholder="Categorical attribute to collapse rows">
            {{main.ui.selectedCategoricalRowAttr}}
          </ui-select-match>
          <ui-select-choices repeat="option in main.ui.availableCategoricalAttr track by option">
            {{option}}
          </ui-select-choices>
        </ui-select>
      </div>

      <div class="control-header">
        <b>Collapse cols</b>
        <ui-select ng-model="main.ui.selectedCategoricalColAttr"
                   ng-change="main.onCollapseColsByAttr(main.ui.selectedCategoricalColAttr)">
          <ui-select-match placeholder="Categorical attribute to collapse cols">
            {{main.ui.selectedCategoricalColAttr}}
          </ui-select-match>
          <ui-select-choices repeat="option in main.ui.availableCategoricalAttr track by option">
            {{option}}
          </ui-select-choices>
        </ui-select>
      </div>

      <div class="control-header">
        <b>Sort order</b>
        <ui-select ng-model="main.ui.selectedSortOrder"
                   ng-change="main.onSortOrderChanged(main.ui.selectedSortOrder)">
          <ui-select-match placeholder="Selected sort order">
            {{main.ui.selectedSortOrder}}
          </ui-select-match>
          <ui-select-choices repeat="option in main.ui.orders track by option">
            {{option}}
          </ui-select-choices>
        </ui-select>
      </div>

      <div class="control-header">
        <b>Cell encoding</b>
        <ui-select id="select-encoding"
                   ng-model="main.ui.selectedEncoding"
                   ng-change="main.onEncodingChanged(main.ui.selectedEncoding)">
          <ui-select-match placeholder="Cell encoding">
            {{main.ui.selectedEncoding}}
          </ui-select-match>
          <ui-select-choices repeat="option in main.ui.encodings track by option">
            {{option}}
          </ui-select-choices>
        </ui-select>
      </div>

      <div class="control-header" ng-show="main.ui.metrics">
        <b>Path metric</b>
        <ui-select id="select-metric"
                   ng-model="main.ui.selectedMetric"
                   ng-change="main.onMetricChanged(main.ui.selectedMetric, main.ui.selectedEncoding)">
          <ui-select-match placeholder="Path metric">
            {{main.ui.selectedMetric}}
          </ui-select-match>
          <ui-select-choices repeat="option in main.ui.metrics track by option">
            {{option}}
          </ui-select-choices>
        </ui-select>
      </div>

      <!-- Legend of matrix cell encodings -->
      <div class="control-header" ng-show="main.ui.hasLegend">
        <b>Legend</b>
        <svg id="encoding-legend">
        </svg>
      </div>

      <!-- Controls for debugging and manually hiding/showing node ids. Disabled by default-->
      <div class="control-header" ng-show="main.ui.debugNodeHiding">
        <input type="text" name="input" ng-model="main.ui.debugNodeHidingId">
        <button ng-click="main.onDebugNodeHiding(main.ui.debugNodeHidingId, true)">Show</button>
        <button ng-click="main.onDebugNodeHiding(main.ui.debugNodeHidingId, false)">Hide</button>
      </div>

      <div class="control-header" ng-show="main.ui.debugNodeLinkLayout">
        <button ng-click="main.onToggleNodeLinkView()">Toggle node-link</button>
      </div>

    </span>

    <!-- Column holding global matrix controls -->

    <!-- TODO: Update the width/height of the svg elements here and in the nodeLinkView-->
    <div class="col-md-7 no-padding-right col-matrix-wrapper full-height">
    <span ng-show="!main.hasActiveQuery && !main.hasQueryError" class="col-md-12 column-matrix full-height"
          id="matrices-row">
      <h4>Connectivity Matrix</h4>
    </span>


    </div>

    <!-- Columns holding the node link view -->
    <span class="col-md-3 no-padding full-height" id="node-link-column">
      <span class="col-md-12 full-height side-panel no-padding">
        <uib-tabset active="activePill" type="tabs" class="full-height">
          <uib-tab index="0" heading="{{main.availablePanels[0]}}">
              <span class="col-md-12">
                <h4>Intermediate Nodes</h4>
                 <div class="column-node-list" id="node-list-col">

                 </div>
              </span>
          </uib-tab>
          <uib-tab index="1" heading="{{main.availablePanels[1]}}">
            <span class="col-md-12">
              <node-link-view-directive
                view-state="main.viewState"
                main-controller="main">
              </node-link-view-directive>
            </span>
          </uib-tab>
          <uib-tab index="2" heading="{{main.availablePanels[2]}}" select="main.test()">
            <span class="col-md-12 full-height">
              <div path-list-view-directive
                view-state="main.viewState"
                main-controller="main"
                class="tab-directive">
              </div>
            </span>
          </uib-tab>
        </uib-tabset>
      </span>
    </span>
  </div>

  <!-- Row the replaces the matrix when there is a query running or query error. -->
  <div ng-show="main.hasActiveQuery || main.hasQueryError" class="jumbotron row query-status-row">
    <p ng-show="main.hasActiveQuery">Query is loading...</p>
    <p ng-show="main.hasQueryError">{{main.queryError}}</p>
  </div>
</div>
